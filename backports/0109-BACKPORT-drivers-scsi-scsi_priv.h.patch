From: Valentine Fatiev <valentinef@nvidia.com>
Subject: [PATCH] BACKPORT: drivers/scsi/scsi_priv.h

Change-Id: Idaa67154c31a5655a88d6c084f2fc0a30de12236
---
 drivers/scsi/scsi_priv.h | 9 +++++++++
 1 file changed, 9 insertions(+)

--- a/drivers/scsi/scsi_priv.h
+++ b/drivers/scsi/scsi_priv.h
@@ -5,7 +5,9 @@
 #include <linux/device.h>
 #include <linux/async.h>
 #include <scsi/scsi_device.h>
+#ifdef HAVE_SCSI_DEVICE_BUDGET_MAP
 #include <linux/sbitmap.h>
+#endif
 
 struct request_queue;
 struct request;
@@ -181,7 +183,9 @@ static inline void scsi_dh_add_device(st
 static inline void scsi_dh_release_device(struct scsi_device *sdev) { }
 #endif
 
+#ifdef HAVE_SCSI_DEVICE_BUDGET_MAP
 extern int scsi_device_max_queue_depth(struct scsi_device *sdev);
+#endif
 
 /* 
  * internal scsi timeout functions: for use by mid-layer and transport
@@ -189,5 +193,10 @@ extern int scsi_device_max_queue_depth(s
  */
 
 #define SCSI_DEVICE_BLOCK_MAX_TIMEOUT	600	/* units in seconds */
+#ifndef HAVE_SCSI_DEVICE_SCSI_INTERNAL_DEVICE_BLOCK
+extern int scsi_internal_device_block(struct scsi_device *sdev);
+extern int scsi_internal_device_unblock(struct scsi_device *sdev,
+					enum scsi_device_state new_state);
+#endif
 
 #endif /* _SCSI_PRIV_H */
